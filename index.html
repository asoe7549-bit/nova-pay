<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nova AI Agency - Pricing</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --tg-theme-bg-color: #1c1c1d;
            --tg-theme-text-color: #ffffff;
            --tg-theme-button-color: #248bcf;
            --tg-theme-secondary-bg-color: #2c2c2e;
        }
        body { background-color: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); font-family: sans-serif; margin: 0; padding: 0; }
        .pricing-card { background-color: var(--tg-theme-secondary-bg-color); border-radius: 16px; padding: 16px; margin-bottom: 12px; border: 1px solid rgba(255,255,255,0.05); cursor: pointer; position: relative; transition: 0.2s; }
        .pricing-card.selected { border-color: var(--tg-theme-button-color); box-shadow: 0 0 8px rgba(36, 139, 207, 0.4); }
        .tag { background-color: var(--tg-theme-button-color); color: white; font-size: 10px; font-weight: bold; padding: 2px 8px; border-radius: 20px; position: absolute; top: -8px; right: 10px; text-transform: uppercase; }
        input[type=range] { width: 100%; accent-color: var(--tg-theme-button-color); }
    </style>
</head>
<body>
    <div id="app" class="max-w-md mx-auto p-4 pb-10">
        <header class="flex justify-between items-center mb-6 pt-2">
            <div>
                <h1 class="text-lg font-bold">Nova_Bananaüçå Agency</h1>
                <p id="user-info" class="text-[10px] text-gray-400">Detecting User...</p>
            </div>
            <div class="flex gap-2">
                <button onclick="toggleLang()" id="lang-btn" class="text-[10px] bg-white/10 px-2 py-1 rounded">Burmese üá≤üá≤</button>
                <select id="curr-selector" onchange="updateUI()" class="bg-[#2c2c2e] text-[10px] px-1 py-1 rounded border border-white/10">
                    <option value="MYR">MYR (RM)</option>
                    <option value="USD">USD ($)</option>
                    <option value="THB">THB (‡∏ø)</option>
                    <option value="MMK">MMK (Ks)</option>
                </select>
            </div>
        </header>

        <h2 id="title-text" class="text-xl font-bold text-center mb-6">Choose Your Plan</h2>

        <div id="packs-container">
            <div class="pricing-card selected" onclick="selectPack(15, this, false)">
                <span class="tag" id="tag-best">Best Value</span>
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-3"><span>üíé</span><div><h3 class="font-bold text-sm" id="pack1-name">Premium Pack</h3><p class="text-xs opacity-50">15 Credits</p></div></div>
                    <div id="price-1" class="text-lg font-black"></div>
                </div>
            </div>
            <div class="pricing-card" onclick="selectPack(50, this, false)">
                <span class="tag" id="tag-agency">Agency</span>
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-3"><span>üöÄ</span><div><h3 class="font-bold text-sm" id="pack2-name">Enterprise Pack</h3><p class="text-xs opacity-50">50 Credits</p></div></div>
                    <div id="price-2" class="text-lg font-black"></div>
                </div>
            </div>
            <div class="pricing-card" id="custom-card" onclick="selectPack(100, this, true)">
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-3"><span>‚öôÔ∏è</span><div><h3 class="font-bold text-sm" id="pack3-name">Custom Pack</h3><p class="text-xs opacity-50" id="custom-credits-label">100 Credits</p></div></div>
                    <div id="price-custom" class="text-lg font-black"></div>
                </div>
                <div id="slider-container" class="mt-4 hidden">
                    <input type="range" min="10" max="500" step="10" value="100" oninput="updateSlider(this.value)">
                    <div class="flex justify-between text-[9px] opacity-40 mt-1"><span>10 Credits</span><span>500 Credits</span></div>
                </div>
            </div>
        </div>

        <!-- ‚ö†Ô∏è PayPal Button Container with Loading Text -->
        <div id="paypal-button-container" class="mt-6 min-h-[50px] text-center text-xs opacity-50">
            PayPal Loading...
        </div>

        <div class="mt-10 p-4 rounded-2xl bg-white/5 border border-white/5">
            <h4 id="why-title" class="text-xs font-bold uppercase tracking-widest text-blue-400 mb-3 text-center">WHY CHOOSE US?</h4>
            <div class="grid grid-cols-2 gap-3 text-[10px]">
                <div class="flex items-center gap-2"><span>‚úÖ</span><span id="b1">8K Resolution</span></div>
                <div class="flex items-center gap-2"><span>‚úÖ</span><span id="b2">Burmese AI</span></div>
                <div class="flex items-center gap-2"><span>‚úÖ</span><span id="b3">Privacy First</span></div>
                <div class="flex items-center gap-2"><span>‚úÖ</span><span id="b4">Instant Add</span></div>
            </div>
        </div>
        <p class="text-center text-[9px] opacity-30 mt-6">Secure Payment via PayPal & Card</p>
    </div>

    <script>
        const CLIENT_ID = "AUaBk-B7Dtj1QGqnp6FtEOKM1hL_dCxXw5YTjoRTGMd1c3EMQRaK5Lknap9FpqbpgVWyJVNQHqu0BvNw"; 
        const WEBHOOK_URL = "https://n8n.trustporthub.com/webhook/paypal-payment-success";
        
        let currentLang = 'EN';
        let selectedCredits = 15;
        let currency = 'MYR';
        const tg = window.Telegram.WebApp;

        const RATES = { MYR: 1, MMK: 500, THB: 10, USD: 0.25 };
        const SYMBOLS = { MYR: 'RM', MMK: 'Ks', THB: '‡∏ø', USD: '$' };
        const TEXTS = {
            EN: { title: "Choose Your Plan", p1: "Premium Pack", p2: "Enterprise Pack", p3: "Custom Pack", best: "Best Value", why: "WHY CHOOSE US?", b1: "8K Resolution", b2: "Burmese AI", b3: "Privacy First", b4: "Instant Add" },
            MM: { title: "·ÄÄ·Äõ·ÄÄ·Ä∫·Äí·ÄÖ·Ä∫·Äù·Äö·Ä∫·Äö·Ä∞·Äõ·Äî·Ä∫", p1: "Premium ·Ä°·ÄÖ·ÄÆ·Ä°·ÄÖ·Äâ·Ä∫", p2: "Enterprise ·Ä°·ÄÖ·ÄÆ·Ä°·ÄÖ·Äâ·Ä∫", p3: "·ÄÖ·Ä≠·Äê·Ä∫·ÄÄ·Äº·Ä≠·ÄØ·ÄÄ·Ä∫·Äù·Äö·Ä∫·Äõ·Äî·Ä∫", best: "·Ä°·Äû·ÄÑ·Ä∑·Ä∫·Äê·Ä±·Ä¨·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏", why: "·Äò·Ä¨·ÄÄ·Äº·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫ ·ÄÄ·Äª·ÄΩ·Äî·Ä∫·ÄØ·Äï·Ä∫·Äê·Ä≠·ÄØ·Ä∑·ÄÄ·Ä≠·ÄØ ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äû·ÄÑ·Ä∑·Ä∫·Äú·Ä≤?", b1: "8K ·Ä°·ÄÄ·Äº·Ää·Ä∫·Äì·Ä¨·Äê·Ä∫", b2: "·Äô·Äº·Äî·Ä∫·Äô·Ä¨ AI", b3: "·Äú·ÄØ·Ä∂·ÄÅ·Äº·ÄØ·Ä∂·ÄÖ·Ä≠·Äê·Ä∫·ÄÅ·Äª·Äõ·Äô·Äæ·ÄØ", b4: "·ÄÅ·Äª·ÄÄ·Ä∫·ÄÅ·Äª·ÄÑ·Ä∫·Ä∏·Äõ·Äõ·Äæ·Ä≠·Äô·Ää·Ä∫" }
        };

        function toggleLang() { currentLang = currentLang === 'EN' ? 'MM' : 'EN'; updateUI(); }

        function updateUI() {
            currency = document.getElementById('curr-selector').value;
            const lang = TEXTS[currentLang];
            const sym = SYMBOLS[currency];

            document.getElementById('title-text').innerText = lang.title;
            document.getElementById('pack1-name').innerText = lang.p1;
            document.getElementById('pack2-name').innerText = lang.p2;
            document.getElementById('pack3-name').innerText = lang.p3;
            document.getElementById('tag-best').innerText = lang.best;
            document.getElementById('why-title').innerText = lang.why;
            document.getElementById('b1').innerText = lang.b1; document.getElementById('b2').innerText = lang.b2;
            document.getElementById('b3').innerText = lang.b3; document.getElementById('b4').innerText = lang.b4;
            document.getElementById('lang-btn').innerText = currentLang === 'EN' ? '·Äô·Äº·Äî·Ä∫·Äô·Ä¨·ÄÖ·Ä¨ üá≤üá≤' : 'English üá∫üá∏';

            document.getElementById('price-1').innerText = `${sym}${15 * RATES[currency]}`;
            document.getElementById('price-2').innerText = `${sym}${50 * RATES[currency]}`;
            document.getElementById('price-custom').innerText = `${sym}${selectedCredits * RATES[currency]}`;
            
            if (window.paypal) renderPayPal();
        }

        function selectPack(credits, el, isCustom) {
            document.querySelectorAll('.pricing-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            selectedCredits = credits;
            document.getElementById('slider-container').classList.toggle('hidden', !isCustom);
            updateUI();
        }

        function updateSlider(val) {
            selectedCredits = parseInt(val);
            document.getElementById('custom-credits-label').innerText = `${val} Credits`;
            updateUI();
        }

        function renderPayPal() {
            const container = document.getElementById('paypal-button-container');
            container.innerHTML = '';
            
            // PayPal doesn't support MMK, so we fallback to USD for MMK selection
            const payCurrency = (currency === 'MMK') ? 'USD' : currency;
            const payAmount = (selectedCredits * RATES[payCurrency]).toFixed(2);

            paypal.Buttons({
                style: { layout: 'vertical', color: 'gold', shape: 'pill', label: 'paypal' },
                createOrder: (data, actions) => actions.order.create({
                    purchase_units: [{ amount: { currency_code: payCurrency, value: payAmount } }]
                }),
                onApprove: (data, actions) => actions.order.capture().then(details => {
                    fetch(WEBHOOK_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            user_id: tg.initDataUnsafe?.user?.id || 'unknown',
                            credits: selectedCredits,
                            amount: payAmount,
                            currency: payCurrency
                        })
                    });
                    tg.showAlert(`üéâ Success! Credits will be added to ID: ${tg.initDataUnsafe?.user?.id || 'unknown'}`);
                    tg.close();
                })
            }).render('#paypal-button-container').catch(err => {
                container.innerHTML = `<p class="text-red-500 text-[10px]">Error loading PayPal. Check Client ID.</p>`;
            });
        }

        function init() {
            if (tg) {
                tg.ready(); tg.expand();
                const user = tg.initDataUnsafe?.user;
                if (user) document.getElementById('user-info').innerText = `User: ${user.first_name} (ID: ${user.id})`;
            }
            // Load PayPal SDK only once with base currency
            const script = document.createElement('script');
            script.src = `https://www.paypal.com/sdk/js?client-id=${CLIENT_ID}&currency=MYR`;
            script.onload = updateUI;
            document.head.appendChild(script);
        }
        init();
    </script>
</body>
</html>